# tx-agent-kit

> Agent pointer map for repo-aware LLMs. Prefer these file pointers before broad search.

## Canonical entry points

- `AGENTS.md`: primary operating rules and hard constraints for agents.
- `README.md`: project overview, prerequisites, and local bootstrap.
- `docs/ARCHITECTURE.md`: system boundaries and dependency flow.
- `docs/QUALITY.md`: enforced invariants and rationale.
- `docs/COMMANDS.md`: command catalog (full + quiet lanes).
- `docs/RUNBOOKS.md`: operational workflows and troubleshooting.
- `docs/DEPLOYMENT.md`: build, migrate, deploy, smoke test.
- `docs/ROLLBACK.md`: rollback procedures.

## Enforcement (mechanical gates)

- `packages/tooling/eslint-config/domain-invariants.js`: import bans and coding constraints.
- `scripts/lint/enforce-domain-invariants.mjs`: cross-file structural invariants.
- `scripts/check-shell-invariants.sh`: shell-level repo policy checks.

## App map

- `apps/api/src/server.ts`: API runtime entrypoint.
- `apps/api/src/server-lib.ts`: API runtime wiring and layers.
- `apps/api/openapi.json`: generated API contract.
- `apps/web/app`: web app routes/pages (use client constrained).
- `apps/web/components`: web UI components + integration suites.
- `apps/web/lib`: web transport/state/auth helpers.
- `apps/mobile`: Expo app code and integration/unit suites.
- `apps/mobile/lib`: mobile API/auth/env client layers.
- `apps/worker/src/index.ts`: worker runtime entrypoint.
- `apps/worker/src/workflows.ts`: Temporal workflows (determinism constraints).
- `apps/worker/src/activities.ts`: side-effectful Temporal activities.
- `apps/docs/content/docs`: docs source of truth for docs site content.

## Package map

- `packages/core/src/domains`: domain logic (domain/ports/application/adapters).
- `packages/contracts/src`: shared effect/Schema contracts.
- `packages/db/src/schema.ts`: Drizzle schema source of truth.
- `packages/db/src/effect-schemas`: table-aligned effect schemas.
- `packages/db/src/factories`: table-aligned test factories.
- `packages/db/drizzle/migrations`: SQL migrations.
- `packages/db/pgtap`: pgTAP trigger/invariant suites.
- `packages/testkit/src`: integration harnesses and shared test runtime helpers.
- `packages/observability/src`: OTEL setup and signal pipelines.
- `packages/logging/src`: structured logging primitives.

## Critical test harness pointers

- `vitest.integration.workspace.ts`: integration workspace composition.
- `vitest.boilerplate.workspace.ts`: boilerplate meta-test workspace.
- `scripts/test/vitest-global-setup.ts`: shared integration preflight + locking.
- `scripts/test/run-integration.sh`: integration lane runner.
- `scripts/test-integration-quiet.sh`: quiet integration runner.
- `scripts/test/run-boilerplate.sh`: boilerplate meta-test runner.
- `scripts/test-boilerplate-quiet.sh`: quiet boilerplate runner.
- `packages/testkit/src/db-auth-context.ts`: API+DB auth test harness.
- `packages/testkit/src/sql-context.ts`: schema-isolated SQL test context.
- `packages/testkit/src/boilerplate.parallel-worktrees.boilerplate.test.ts`: 2-worktree, 2-schema, 2x stack non-interference meta-test.

## Critical flow coverage pointers

- `apps/api/src/api.integration.test.ts`: critical API endpoint + idempotency coverage.
- `apps/web/components/AuthForm.integration.test.tsx`
- `apps/web/components/CreateWorkspaceForm.integration.test.tsx`
- `apps/web/components/CreateTaskForm.integration.test.tsx`
- `apps/web/components/CreateInvitationForm.integration.test.tsx`
- `apps/web/components/AcceptInvitationForm.integration.test.tsx`
- `apps/web/components/SignOutButton.integration.test.tsx`
- `apps/mobile/components/AuthForm.integration.test.tsx`
- `apps/mobile/components/CreateWorkspaceForm.integration.test.tsx`
- `apps/mobile/components/CreateTaskForm.integration.test.tsx`
- `apps/mobile/components/CreateInvitationForm.integration.test.tsx`
- `apps/mobile/components/AcceptInvitationForm.integration.test.tsx`
- `apps/mobile/components/SignOutButton.integration.test.tsx`
- `apps/mobile/components/providers/AuthBootstrapProvider.integration.test.tsx`
- `apps/mobile/lib/client-api.integration.test.ts`

## Worktrees and parallel agent development

- `scripts/worktree/setup.sh`: per-worktree schema/env/port/task-queue setup.
- `scripts/worktree/derive-ports.sh`: deterministic worktree port derivation.
- `scripts/worktree/lib/ports.sh`: collision-aware port allocation.
- `scripts/worktree/manage.sh`: create/list/remove worktree workflows.
- `scripts/worktree/ensure-shared-infra.sh`: shared infra bootstrap across worktrees.

## Infra and observability operations

- `scripts/start-dev-services.sh`: shared Docker infra ensure.
- `scripts/test/check-observability.sh`: OTEL smoke validation gate.
- `scripts/test/emit-observability-smoke.ts`: signal emission helper.
- `scripts/temporal/start-dev.sh`: local Temporal CLI bootstrap.
- `scripts/temporal/status.sh`: local Temporal runtime status.
- `scripts/temporal/stop-dev.sh`: local Temporal runtime shutdown.
- `docker-compose.yml`: local infra topology.

## Code generation and scaffolding

- `packages/tooling/scaffold/src/cli.ts`: CRUD scaffold CLI implementation.
- `apps/docs/scripts/generate-api-docs.ts`: OpenAPI -> docs reference generator.
- `apps/web/lib/api/generated`: generated web API client.
- `apps/web/lib/api/orval-mutator.ts`: web client mutation behavior.
- `apps/mobile/lib/api/orval-mutator.ts`: mobile client mutation behavior.

## Deployment and smoke validation

- `scripts/deploy/build-images.sh`: API/worker image build pipeline.
- `scripts/deploy/migrate.sh`: migration runner for deploy environments.
- `scripts/deploy/deploy-compose.sh`: compose deployment workflow.
- `scripts/deploy/smoke-api.sh`: post-deploy critical-flow smoke checks.
- `scripts/deploy/gcp`: optional GCP bootstrap/validate/teardown scripts.

## Public docs links (secondary)

- https://agentkit.txdocs.dev/docs: human-oriented docs site.
- https://agentkit.txdocs.dev/llms-full.txt: expanded narrative map.
